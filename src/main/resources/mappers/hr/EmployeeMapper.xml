<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.beauty1nside.hr.mapper.EmployeeMapper">

	
	<select id="countTotalEmployees" resultType="int">
	    SELECT COUNT(*) FROM employees
	</select>

	<!-- 전체 사원 조회 -->
    <select id="getAllEmployees" resultType="com.beauty1nside.hr.dto.EmployeeDTO">
        SELECT 
            e.employee_num AS employeeNum,
            e.employee_id AS employeeId,
            e.employee_name AS employeeName,
            e.email AS email,
            e.phone AS phone,
            e.hire_date AS hireDate,
            e.position AS position,
            e.status AS status,
            e.employment_type AS employmentType,
            d.department_name AS departmentName
        FROM hr_employee e
        LEFT JOIN hr_department d ON e.department_num = d.department_num
        ORDER BY e.employee_num DESC
    </select>
	
	<!-- 특정 사원 조회 -->
	<select id="getEmployeeById" parameterType="long" resultType="EmployeeDTO">
		SELECT * FROM hr_employee
		WHERE employee_num = #{employeeNum}
	</select>
	
	<!-- 사원 추가 -->
    <insert id="insertEmployee" parameterType="EmployeeDTO">
        INSERT INTO hr_employee (
                                  employee_num,
                                  employee_id,
                                   employee_name,
                                    email,
                                    phone, 
                                    position,
                                    status,
                                    company_num,
                                    department_num,
                                    hire_date) 
                VALUES (
                         hr_employee_SEQ.NEXTVAL,
                         #{employeeId},
                         #{employeeName},
                         #{email},
                         #{phone},
                         #{position},
                         #{status},
                         #{companyNum},
                         #{departmentNum},
                         SYSDATE
                         )
    </insert>
    
    <!-- 사원 정보 수정 -->
    <update id="updateEmployee" parameterType="EmployeeDTO">
    	UPDATE hr_employee
    	SET
    	    employee_name = #{employeeName},
    	    email = #{email},
			phone = #{phone},
            position = #{position},
            status = #{status},
            department_num = #{departmentNum},
            update_date = SYSDATE
         FROM employee_num = #{employeeNum}
    </update>
    
    <!-- 사원 삭제 -->
    <delete id="deleteEmployee" parameterType="long">
    	DELETE FROM hr_employee WHERE employee_num = #{employeeNum}
    </delete>

</mapper>