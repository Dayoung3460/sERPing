<!DOCTYPE html>
<html 
lang="en"
layout:decorate="~{layouts/layout}" 
xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
>

<head>

  <style>
  	#custom-container{
		background-color: #f8f9fa; /* 연한 회색 배경 */
		padding: 20px;
		border-radius: 10px;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* 박스 그림자 */
		margin-bottom: 20px;
	
	}
  </style>

</head>

<body layout:fragment="content">
  <!-- 페이지 내용 시작 -->

      <div class="container">
		<h3>주문 등록</h3>
        <div class="row mb-3">
	        <div class="col-12">
	            <div class="card">
	                <div class="card-body">
	                    <h4 class="card-title">검색 조건</h4>
	                    <p class="card-description">검색 조건을 선택하세요.</p>
	                        <div class="d-flex align-items-center gap-3">
	                            <!-- 라디오 버튼 -->
	                            <div class="d-flex gap-3">
	                                <div class="form-check">
	                                    <label class="form-check-label">
	                                        <input type="radio" class="form-check-input" name="optionsRadios" value="notSelect" checked onclick="toggleDateInputs(false)">
	                                        사용안함
	                                    </label>
	                                </div>
	                                <div class="form-check">
	                                    <label class="form-check-label">
	                                        <input type="radio" class="form-check-input" name="optionsRadios" value="orderDate" onclick="toggleDateInputs(true)">
	                                        주문일자
	                                    </label>
	                                </div>
	                                <div class="form-check">
	                                    <label class="form-check-label">
	                                        <input type="radio" class="form-check-input" name="optionsRadios" value="dueDate" onclick="toggleDateInputs(true)">
	                                        납기일자
	                                    </label>
	                                </div>
	                            </div>
	
	                            <!-- 날짜 입력 -->
	                            <div class="d-flex gap-3">
	                                <div>
	                                    <label for="startDate">시작 날짜</label>
	                                    <input type="date" class="form-control" id="startDate" name="startDate" disabled>
	                                </div>
	                                <div>
	                                    <label for="endDate">끝 날짜</label>
	                                    <input type="date" class="form-control" id="endDate" name="endDate" disabled>
	                                </div>
	                            </div>
	                        </div>
	
	                        <div class="form-group m-3">
	                            <label for="selectBhf">발주지점</label>
	                            <select class="form-control" id="selectBhf">
	                            	<option>all</option>
	                                <option>발주지점1</option>
	                                <option>발주지점2</option>
	                                <option>발주지점3</option>
	                                <option>yedam</option>
	                            </select>
	                        </div>
							<div class="col-12 text-center">
	                        	<button class="btn btn-primary mr-2" onclick="search()">검색</button>
	                        	<button class="btn btn-light"        onclick="reset()">초기화</button>
	                        </div>
	                </div>
	            </div>
	        </div>
	    </div>
        
        
        <div class="row">
        	<div class="col-md-12  grid-margin stretch-card">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">검색 조건</h4>
                <p class="card-description">그리드 - 검색한 지점측 발주 신청 리스트 출력</p>
                <div id="orderList"></div>
                <div id="pagination" class="tui-pagination"></div>

              </div>
            </div>
          </div>
        </div>
        
        
        
        
        
        
        
      </div>
      <!-- content-wrapper ends -->
  <!-- 페이지 내용 끝 -->
<script>
    function toggleDateInputs(enable) {
      document.getElementById("startDate").disabled = !enable;
      document.getElementById("endDate").disabled = !enable;
      
     
    }
    
	var Grid = tui.Grid;

	const dataSource = {
			api: {
				readData: { url: 'http://localhost:81/bsn/rest/orderList', method: 'GET', initParams: { page: 1 }},
			},
			contentType: 'application/json'
		};
	//상품 테이블
	const orderList = new Grid({
			el: document.getElementById('orderList'), // 컨테이너 엘리먼트
			pageOptions: {
			useClient: false,
			perPage: 10,
		},
		columns: [ 
			{ header : "주문ID", name : "orderId", sortable : true},
			{ header : "주문명", name : "orderName", width: 'auto',  sortable : true},
			{ header : "발주코드", name : "orderCode"},
			{ header : "지점코드", name : "branchOfficeId"},
			// { header : "회사번호", name : "companyNum"},
			{ header : "주문일", name : "orderDate", formatter: ({ value }) => formatDate(value, 'order'), width: 'auto', sortable : true},
			{ header : "납기일", name : "dueDate", formatter: ({ value }) => formatDate(value, 'due'), width: 'auto', sortable : true},
			{ header : "비고", name : "remark", width: 'auto'},
		],
		data: dataSource
	});
	
	//그리드 날짜 형식 변경(데이터 수정X, 표기만)
	function formatDate(dateString, type) {
	    if (!dateString) return ''; // 데이터가 없으면 빈 문자열 반환
	    const date = new Date(dateString);
	    if (isNaN(date)) return dateString; // 날짜 변환이 실패하면 원본 유지

	    return type === 'order' 
	        ? date.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' }) // "2025년 2월 17일"
	        : date.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' }); // "02/17 (월)"
	}
	
	//검색
	function search(){
		let selectedOption = document.querySelector('input[name="optionsRadios"]:checked').value; // 라디오 버튼 선택 값
	    let startDate = document.getElementById("startDate").value; // 시작 날짜
	    let endDate = document.getElementById("endDate").value; // 끝 날짜
	    let selectedBhf = document.getElementById("selectBhf").value; // 발주지점 선택 값
	    
	    console.log(selectedOption, startDate, endDate, selectedBhf);
	    
	    let params = {
	    		"deteOption": selectedOption,
	            "startDate": startDate,
	            "endDate": endDate,
	            "branch": selectedBhf
	    };
	    
	    console.log("검색 조건:", params);
	    
	    orderList.readData(1, params, true);
	}
</script>



</body>

</html>