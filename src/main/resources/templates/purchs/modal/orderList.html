<html xmlns:th="http://www.thymeleaf.org">

<body>
 
   <style>
	    #custom-modal-container{
			background-color: #f8f9fa; /* ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
			padding: 20px;
			border-radius: 10px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* ë°•ìŠ¤ ê·¸ë¦¼ì */
			margin-bottom: 20px;
		
		}
    

</style>


<div class="container mt-4">
	   <!-- ê²€ìƒ‰ì°½ -->
	<div class="search-grid" id="custom-modal-container">
	    <div class="d-flex flex-wrap align-items-center gap-3">
	        <div class="col-auto">
		        <label class="form-label">ë‚©ê¸°ì¼ì</label>
		        <div class="input-group">
			          <input type="date" id="searchStartDate" class="form-control">
			          <span class="input-group-text">~</span>
			          <input type="date" id="searchEndDate" class="form-control">
		        </div>
		     </div>
	        <div class="d-flex align-items-center">
	            <span class="label-search me-2">í‘œì‹œìˆ˜ëŸ‰</span>
	            <select name="display_num_amount" id="product_order_display_amount" class="form-control w-auto" onchange="changeOrderDisplay()">
	                <option value="10" selected>10</option>
	                <option value="20">20</option>
	                <option value="50">50</option>
	                <option value="100">100</option>
	            </select>
	        </div>
	        <button type="button" class="btn btn-primary ms-auto" onclick="orderlistSearch()">ê²€ìƒ‰</button>
	        <button type="button" class="btn btn-secondary" onclick="resetOrderFilters()">ì´ˆê¸°í™”</button>
	    </div>
	</div>
	
	<!-- ìƒí’ˆë³„ ê·¸ë¦¬ë“œ -->
	<div id="table-container" class="mt-3">
	    <div id="orderListGrid"></div>
	</div>
	


</div>

 <script>

console.log("ê°¯ìˆ˜ê·¸ë¦¬ë“œ")
document.addEventListener("DOMContentLoaded", function () {
    //console.log("âœ… DOMContentLoaded ì‹¤í–‰ë¨");

    // âœ… orderListGridê°€ ìˆëŠ”ì§€ í™•ì¸
    //console.log("ğŸ“Œ productNumGrid ì—˜ë¦¬ë¨¼íŠ¸ ì¡´ì¬ ì—¬ë¶€: ", document.getElementById('productNumGrid'));

    if (document.getElementById('orderListGrid')) {
        initOrderListGrid();
    } else {
        console.warn("âŒ productNumGrid ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }
});


let orderListGrid;



function initOrderListGrid() {
    //console.log("âœ… initProductGrid() ì‹¤í–‰");

    
    if (!selectedCompanyNum) {
        console.error("âŒ ì„¸ì…˜ì—ì„œ companyNum ê°’ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ.");
        return;
    }

    //console.log("âœ… ì„¤ì •ëœ companyNum:", selectedCompanyNum);

    const orderListDataSource = {
        api: {  
            readData: { 
                url: '/purchs/rest/orderlist', 
                method: 'GET',
                requestOptions: {
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'same-origin'
                },
                initParams: { 
                    page: 1,
                    perPage: 10,
                    companyNum: selectedCompanyNum
                }
            }
        },
        contentType: 'application/json',
        serverSidePagination: true
    };

    orderListGrid = new tui.Grid({
        el: document.getElementById('orderListGrid'),
        data: orderListDataSource, 
        scrollX :true,
        scrollY : false,
        rowHeight: 40,  // âœ… í–‰ í¬ê¸° ê³ ì • (ê¸°ë³¸ê°’: auto â†’ 40pxë¡œ ì§€ì •)
        pageOptions: {
            useClient: false,
            perPage: 5,
        },
        bodyHeight: 'auto', 
        columns: [
            { header: "ì£¼ë¬¸ë²ˆí˜¸", name: "orderId", rowSpan: true ,align: "left"},
            { header: "ì£¼ë¬¸ëª…", name: "orderName", rowSpan: true ,align: "left",},
            { header: "ìƒí’ˆì½”ë“œ", name: "goodsCode",align: "left" },
            { header: "ìƒí’ˆëª…", name: "goodsName" ,align: "left"},
            { header: "ì˜µì…˜ëª…", name: "optionName",align: "left" },
            { header: "ê·œê²©", name: "goodsStandard",align: "center"},
            { header: "ì£¼ë¬¸ìˆ˜", name: "quantity",align: "right"},
            { header: "ì£¼ë¬¸ì¼", name: "orderDate",align: "center",},
            { header: "ë‚©ê¸°ì¼", name: "dueDate",align: "center"},
            
        ]
    });

    //console.log("âœ… ìƒí’ˆ ê·¸ë¦¬ë“œ ì´ˆê¸°í™” ì™„ë£Œ");
    
 
    
}



// âœ… í‘œì‹œ ìˆ˜ëŸ‰ ë³€ê²½
function changeOrderDisplay() {
    let gap = parseInt(document.querySelector('#product_order_display_amount').value);
    orderListGrid.setPerPage(gap);
    orderListGrid.reloadData();
}

// âœ… ê²€ìƒ‰ ì‹¤í–‰
function orderlistSearch() {
    let startDate = document.querySelector('#searchStartDate').value;
    let endDate = document.querySelector('#searchEndDate').value;

    orderListGrid.setRequestParams({
        "companyNum": [[${session.companyNum}]],
        "startDate": startDate,
        "endDate": endDate
    });

    orderListGrid.reloadData();
}

// âœ… í•„í„° ì´ˆê¸°í™”
function resetOrderFilters() {
    document.querySelector('#searchStartDate').value = '';
    document.querySelector('#searchEndDate').value = '';
    document.querySelector('#product_order_display_amount').value = '10';

    orderListGrid.setRequestParams({
        "companyNum": [[${session.companyNum}]],
        "startDate": '',
        "endDate": ''
    });

    orderListGrid.reloadData();
}

</script>
</body>



