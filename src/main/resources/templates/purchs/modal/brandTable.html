<html xmlns:th="http://www.thymeleaf.org">
<style>
#custom-Modal-container{
		background-color: #f8f9fa; /* ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
		padding: 20px;
		border-radius: 10px;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* ë°•ìŠ¤ ê·¸ë¦¼ì */
		margin-bottom: 20px;
	
		}
</style>


<body>


	<!-- ê²€ìƒ‰ì°½ -->
	<div class="search-grid" id="custom-Modal-container">
			<div class="row 2row">
				<div class="col-1"></div>
				<div class="col-5 row ">
					<span class="label-search col-4">ë¸Œëœë“œëª…</span>
					<input type="text" name="brandName" id="searchBrandName" class="form-control">
				</div>
				<div class="col-1"></div>
				<div class="col-5 row ">
					<span class="label-search col-4">í‘œì‹œìˆ˜ëŸ‰</span>
					<select name="display_amount" id="brand_display_amount" class="form-control" onchange="changeDisplay()">
						<option value="5" selected>5</option>
						<option value="10">10</option>
						<option value="20">20</option>
						<option value="50">50</option>
						<option value="100">100</option>
					</select> 
				</div>
			</div>
			<div class="row 3row mt-3 mb-3">
				<div class="col-4"></div>
				<button type="button" class="btn btn-primary col-1" onclick="brandSearch()">ê²€ìƒ‰</button>
				<div class="col-1"></div>
				<button type="button" class="btn btn-secondary col-1" onclick="reset()">ì´ˆê¸°í™”</button>
			</div>

		</div>
		<!-- ê·¸ë¦¬ë“œ -->
		<div id="table-container">
			<div id="brandGrid"></div>
		</div>
    
</body>

<script>
document.addEventListener("DOMContentLoaded", function () {
    // âœ… í˜ì´ì§€ê°€ ì™„ì „íˆ ë¡œë“œëœ í›„ ì‹¤í–‰
    const brandDataSource = {
        api: {
            readData: {
                url: '/purchs/rest/brand/list',
                method: 'GET',
                initParams: { page: 1, 
                			perPage: 5, 
                			companyNum: [[${session.companyNum}]] },
                beforeRequest: function (request) {
                    console.log("ğŸ“¢ ì„œë²„ë¡œ ìš”ì²­ ë³´ë‚´ê¸° ì „ requestParams:", request.params);
                },
                afterResponse: function (response) {
                    console.log("ì„œë²„ì‘ë‹µ ê²°ê³¼==", response);
                }
            },
        },
        contentType: 'application/json'
    };

    // âœ… `brandGrid` ë³€ìˆ˜ë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ì„ ì–¸
    window.brandGrid = new tui.Grid({
        el: document.querySelector('#brandGrid'),
        pageOptions: {
            useClient: false,
            perPage: 5,
            companyNum: [[${session.companyNum}]]
        },
        columns: [
            { header: "ë¸Œëœë“œì½”ë“œ", name: "brandCode", align: "left",sortable: true },
            { header: "ë¸Œëœë“œëª…", name: "brandName", align: "left",sortable: true }
        ],
        data: brandDataSource,
    });

    function changeDisplay() {
        let gap = parseInt(document.querySelector('#brand_display_amount').value);
        brandGrid.setPerPage(gap, brandDataSource);
        brandGrid.readData();
    }

    function brandSearch() {
        let brandName = document.querySelector('#searchBrandName').value;
        console.log("ê²€ìƒ‰ì–´==", brandName);
        brandGrid.setRequestParams({
            "companyNum": [[${session.companyNum}]],
            "brandName": brandName
        });
        brandGrid.readData();
    }

    brandGrid.on('click', (ev) => {
        const { rowKey } = ev;
        const rowData = brandGrid.getRow(rowKey);
        console.log("ì„ íƒëœ í–‰ ë°ì´í„°:", rowData);

        sessionStorage.setItem("selectedBrandId", rowData.brandId);
        sessionStorage.setItem("selectedBrandName", rowData.brandName);

        console.log("ë³´ë‚¼ ë°ì´í„° ==", rowData.brandId, rowData.brandName);

        // âœ… ê¸°ì¡´ ì„ íƒëœ í–‰ì˜ í•˜ì´ë¼ì´íŠ¸ ì œê±°
        brandGrid.getData().forEach((data) => {
            brandGrid.removeRowClassName(data.rowKey, 'highlight-row');
        });

        // âœ… ì„ íƒí•œ í–‰ ìŠ¤íƒ€ì¼ ì ìš©
        const rowElement = brandGrid.getElement(rowKey);
        if (rowElement) {
            rowElement.classList.add('highlight-row');
        }
    });

    // âœ… ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡ (HTMLì—ì„œ ì§ì ‘ í˜¸ì¶œ ê°€ëŠ¥)
    window.changeDisplay = changeDisplay;
    window.brandSearch = brandSearch;
});
</script>
